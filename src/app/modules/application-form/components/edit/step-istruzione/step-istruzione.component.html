<div [formGroup]="form">

  <div formGroupName="formIstruzione">

    <div fxLayout="row wrap" fxLayout.sm="column" fxLayout.xs="column">
      <mat-form-field appearance="outline" fxFlex="100">
        <mat-label>Tipologia istituto</mat-label>
        <mat-select #tipologiaSelect
                    [formControl]="getSingleForm('tipologia')"
                    placeholder="Seleziona tipologia titolo di studio">

          <ngx-mat-select-search
            [formControl]="getSingleForm('tipologiaDropdown')"
            [noEntriesFoundLabel]="'Nessun risultato'"
            [placeholderLabel]="'Cerca tipologia . . '">
          </ngx-mat-select-search>

          <mat-option *ngFor="let x of (filtroTipologie | async)" [value]="x">
            {{x.desc}}
          </mat-option>
        </mat-select>

        <mat-error *ngIf="getSingleForm('tipologia').hasError('required')">Campo Obbligatorio</mat-error>
        <mat-error *ngIf="getSingleForm('tipologiaDropdown').hasError('required')">Campo Obbligatorio</mat-error>
      </mat-form-field>

    </div>

    <div fxLayout="row wrap" *ngIf="renderTitoli" fxLayout.sm="column" fxLayout.xs="column">

      <mat-form-field appearance="outline" fxFlex="100">
        <mat-label>Titolo di studio</mat-label>
        <mat-select #titoliSelect
                    [formControl]="getSingleForm('titolo')"
                    placeholder="Seleziona titolo di studio">

          <ngx-mat-select-search
            [formControl]="getSingleForm('titoloDropdown')"
            [noEntriesFoundLabel]="'Nessun risultato'"
            [placeholderLabel]="'Cerca tipologia . . '">
          </ngx-mat-select-search>

          <mat-option *ngFor="let x of (filtroTitolo | async)" [value]="x">
            {{x.desc}}
          </mat-option>
        </mat-select>

        <mat-error *ngIf="getSingleForm('titolo').hasError('required')">Campo Obbligatorio</mat-error>
        <mat-error *ngIf="getSingleForm('titoloDropdown').hasError('required')">Campo Obbligatorio</mat-error>
      </mat-form-field>

    </div>

    <div fxLayout="row wrap" *ngIf="renderIndirizzi" fxLayout.sm="column" fxLayout.xs="column">

      <mat-form-field appearance="outline" fxFlex="100">
        <mat-label>Indirizzo di studio</mat-label>
        <mat-select #indirizziSelect
                    [formControl]="getSingleForm('indirizzo')"
                    placeholder="Seleziona indirizzo studio">

          <ngx-mat-select-search [formControl]="getSingleForm('indirizzoDropdown')"
                                 [noEntriesFoundLabel]="'Nessun risultato'"
                                 [placeholderLabel]="'Cerca tipologia . . '">
          </ngx-mat-select-search>
          <mat-option *ngFor="let x of (filtroIndirizzi | async)" [value]="x">
            {{x.desc}}
          </mat-option>
        </mat-select>
        <mat-error *ngIf="getSingleForm('indirizzo').hasError('required')">Campo Obbligatorio</mat-error>
        <mat-error *ngIf="getSingleForm('indirizzoDropdown').hasError('required')">Campo Obbligatorio</mat-error>
      </mat-form-field>

    </div>

    <div *ngIf="renderAltroIndirizzo">
      <mat-form-field appearance="outline" fxFlex="100">
        <mat-label>Specificare altro indirizzo</mat-label>
        <input matInput [formControl]="getSingleForm('altroIndirizzo')" placeholder="altro indirizzo">
      </mat-form-field>
    </div>

    <div fxLayout="row" fxLayout.sm="column" fxLayout.xs="column">

      <mat-form-field appearance="outline" fxFlex="40">
        <mat-label>Indirizzo fisico dell'istituto</mat-label>
        <input [formControl]="getSingleForm('indirizzoFisico')" matInput placeholder="Indirizzo dell'istituto">
      </mat-form-field>

      <mat-form-field appearance="outline" fxFlex="40">
        <mat-label>Nome istituto</mat-label>
        <input [formControl]="getSingleForm('nomeIstituto')" matInput placeholder="Nome dell'istituto">
      </mat-form-field>

      <mat-form-field appearance="outline" fxFlex="20">
        <mat-label>Data conseguimento</mat-label>
        <input [formControl]="getSingleForm('dataConseguimento')" matInput maxlength="4" minlength="4" placeholder="Anno Diploma">

        <mat-error *ngIf="getSingleForm('dataConseguimento').hasError('required')">Campo Obbligatorio</mat-error>
        <mat-error *ngIf="getSingleForm('dataConseguimento').hasError('onlyNumber')">Inserire nel campo solo numberi</mat-error>
        <mat-error *ngIf="getSingleForm('dataConseguimento').hasError('max')">L'anno Ã¨ superiore all'anno corrente</mat-error>
        <mat-error *ngIf="getSingleForm('dataConseguimento').hasError('minlength')">L'anno deve avere solo 4 numeri</mat-error>
        <mat-error *ngIf="getSingleForm('dataConseguimento').hasError('maxlength')">L'anno deve avere solo 4 numeri</mat-error>
      </mat-form-field>

    </div>

    <div fxLayout="row" fxLayout.sm="column" fxLayout.xs="column">

      <mat-form-field appearance="outline" fxFlex="39">
        <mat-label>Provincia Istituto</mat-label>
        <mat-select #provinceSelect
                    [formControl]="getSingleForm('provinciaIstituto')"
                    placeholder="Seleziona Provincia istituto">

          <ngx-mat-select-search [formControl]="getSingleForm('provinceDropdown')"
                                 [noEntriesFoundLabel]="'Nessun risultato'"
                                 [placeholderLabel]="'Cerca provincia . . '">
          </ngx-mat-select-search>

          <mat-option *ngFor="let prov of (filtroProvince | async)" [value]="prov">
            {{prov.nome}}
          </mat-option>
        </mat-select>

        <mat-error *ngIf="getSingleForm('provinciaIstituto').hasError('required')">Campo Obbligatorio</mat-error>
      </mat-form-field>

      <mat-form-field appearance="outline" fxFlex="39">
        <mat-label>Comune Istituto</mat-label>
        <mat-select #comuneSelect
                    [formControl]="getSingleForm('comuneIstituto')"
                    placeholder="Seleziona Comune istituto">

          <ngx-mat-select-search [formControl]="getSingleForm('comuniDropdown')"
                                 [noEntriesFoundLabel]="'Nessun risultato'"
                                 [placeholderLabel]="'Cerca comune . . '">
          </ngx-mat-select-search>

          <mat-option *ngFor="let x of (filtroComuni | async)" [value]="x">
            {{x.nome}}
          </mat-option>
        </mat-select>
        <mat-error *ngIf="getSingleForm('comuneIstituto').hasError('required')">Campo Obbligatorio</mat-error>
      </mat-form-field>

    </div>

    <div fxLayout="column">
      <div fxFlex="row" fxLayoutGap="15px" fxLayoutAlign="end center" fxLayoutAlign.gt-md="end center" fxLayoutAlign.lt-md="space-between center">
        <button class="stepper-btn small" color="primary" mat-flat-button matStepperPrevious>Indietro</button>
        <button class="stepper-btn small" color="primary" [disabled]="allowNextStep()" mat-flat-button matStepperNext>Avanti</button>
      </div>
    </div>

  </div>
</div>
