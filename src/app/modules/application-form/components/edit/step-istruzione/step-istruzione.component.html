<div [formGroup]="form">

  <div formGroupName="formIstruzione">

    <div fxLayout="row wrap" fxLayout.sm="column" fxLayout.xs="column">
      <mat-form-field appearance="outline" fxFlex="100">
        <mat-label>Tipologia istituto</mat-label>
        <mat-select #tipologiaSelect
                    formControlName="tipologia"
                    placeholder="Seleziona tipologia titolo di studio">

          <ngx-mat-select-search
            formControlName="tipologiaDropdown"
            [noEntriesFoundLabel]="'Nessun risultato'"
            [placeholderLabel]="'Cerca tipologia . . '">
          </ngx-mat-select-search>

          <mat-option *ngFor="let x of (filtroTipologie | async)" [value]="x">
            {{x.desc}}
          </mat-option>
        </mat-select>

        <mat-error *ngIf="getSingleForm('tipologia').hasError('required')">Campo Obbligatorio</mat-error>
        <mat-error *ngIf="getSingleForm('tipologiaDropdown').hasError('required')">Campo Obbligatorio</mat-error>
      </mat-form-field>

    </div>

    <div fxLayout="row wrap" *ngIf="renderTitoli" fxLayout.sm="column" fxLayout.xs="column">

      <mat-form-field appearance="outline" fxFlex="100">
        <mat-label>Titolo di studio</mat-label>
        <mat-select #titoliSelect
                    formControlName="titolo"
                    placeholder="Seleziona titolo di studio">

          <ngx-mat-select-search
            formControlName="titoloDropdown"
            [noEntriesFoundLabel]="'Nessun risultato'"
            [placeholderLabel]="'Cerca tipologia . . '">
          </ngx-mat-select-search>

          <mat-option *ngFor="let x of (filtroTitolo | async)" [value]="x">
            {{x.desc}}
          </mat-option>
        </mat-select>

        <mat-error *ngIf="getSingleForm('titolo').hasError('required')">Campo Obbligatorio</mat-error>
        <mat-error *ngIf="getSingleForm('titoloDropdown').hasError('required')">Campo Obbligatorio</mat-error>
      </mat-form-field>

    </div>

    <div fxLayout="row wrap" *ngIf="renderIndirizzi" fxLayout.sm="column" fxLayout.xs="column">

      <mat-form-field appearance="outline" fxFlex="100">
        <mat-label>Indirizzo di studio</mat-label>
        <mat-select #indirizziSelect
                    formControlName="indirizzo"
                    placeholder="Seleziona indirizzo studio">

          <ngx-mat-select-search formControlName="indirizzoDropdown"
                                 [noEntriesFoundLabel]="'Nessun risultato'"
                                 [placeholderLabel]="'Cerca tipologia . . '">
          </ngx-mat-select-search>
          <mat-option *ngFor="let x of (filtroIndirizzi | async)" [value]="x">
            {{x.desc}}
          </mat-option>
        </mat-select>
        <mat-error *ngIf="getSingleForm('indirizzo').hasError('required')">Campo Obbligatorio</mat-error>
        <mat-error *ngIf="getSingleForm('indirizzoDropdown').hasError('required')">Campo Obbligatorio</mat-error>
      </mat-form-field>

    </div>

    <div *ngIf="renderAltroIndirizzo">
      <mat-form-field appearance="outline" fxFlex="100">
        <mat-label>Specificare altro indirizzo</mat-label>
        <input matInput formControlName="altroIndirizzo" placeholder="altro indirizzo">
      </mat-form-field>
    </div>

    <div fxLayout="row" fxLayout.sm="column" fxLayout.xs="column">

      <mat-form-field appearance="outline" fxFlex="40">
        <mat-label>Indirizzo fisico dell'istituto</mat-label>
        <input formControlName="indirizzoFisico" matInput placeholder="Indirizzo dell'istituto">
      </mat-form-field>

      <mat-form-field appearance="outline" fxFlex="40">
        <mat-label>Nome istituto</mat-label>
        <input formControlName="nomeIstituto" matInput placeholder="Nome dell'istituto">
      </mat-form-field>

      <mat-form-field appearance="outline" fxFlex="20">
        <mat-label>Anno conseguimento</mat-label>
        <input formControlName="dataConseguimento" matInput maxlength="4" minlength="4" placeholder="ex: 2001">

        <mat-error *ngIf="getSingleForm('dataConseguimento').hasError('required')">Campo Obbligatorio</mat-error>
        <mat-error *ngIf="getSingleForm('dataConseguimento').hasError('onlyNumber')">Inserire nel campo solo numberi</mat-error>
        <mat-error *ngIf="getSingleForm('dataConseguimento').hasError('max')">L'anno Ã¨ superiore all'anno corrente</mat-error>
        <mat-error *ngIf="getSingleForm('dataConseguimento').hasError('minlength')">L'anno deve avere solo 4 numeri</mat-error>
        <mat-error *ngIf="getSingleForm('dataConseguimento').hasError('maxlength')">L'anno deve avere solo 4 numeri</mat-error>
      </mat-form-field>

    </div>

    <div fxLayout="row" fxLayout.sm="column" fxLayout.xs="column">

      <mat-form-field appearance="outline" fxFlex="39">
        <mat-label>Provincia Istituto</mat-label>
        <mat-select #provinceSelect
                    formControlName="provinciaIstituto"
                    placeholder="Seleziona Provincia istituto">

          <ngx-mat-select-search formControlName="provinceDropdown"
                                 [noEntriesFoundLabel]="'Nessun risultato'"
                                 [placeholderLabel]="'Cerca provincia . . '">
          </ngx-mat-select-search>

          <mat-option *ngFor="let prov of (filtroProvince | async)" [value]="prov">
            {{prov.nome}}
          </mat-option>
        </mat-select>

        <mat-error *ngIf="getSingleForm('provinciaIstituto').hasError('required')">Campo Obbligatorio</mat-error>
      </mat-form-field>

      <mat-form-field appearance="outline" fxFlex="39">
        <mat-label>Comune Istituto</mat-label>
        <mat-select #comuneSelect
                    formControlName="comuneIstituto"
                    placeholder="Seleziona Comune istituto">

          <ngx-mat-select-search formControlName="comuniDropdown"
                                 [noEntriesFoundLabel]="'Nessun risultato'"
                                 [placeholderLabel]="'Cerca comune . . '">
          </ngx-mat-select-search>

          <mat-option *ngFor="let x of (filtroComuni | async)" [value]="x">
            {{x.nome}}
          </mat-option>
        </mat-select>
        <mat-error *ngIf="getSingleForm('comuneIstituto').hasError('required')">Campo Obbligatorio</mat-error>
      </mat-form-field>

    </div>

    <app-stepper [isValid]="form.controls.formIstruzione.valid"></app-stepper>

  </div>
</div>
